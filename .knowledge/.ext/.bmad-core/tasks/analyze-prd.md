<!-- Powered by BMAD™ Core -->

# 分析PRD文档任务

## ⚠️ 重要提醒 ⚠️

**这是个可执行的工作流程，不是参考文档**

用这个任务时：

1. **必须分析现有PRD** - 不能凭空创建需求
2. **必须逐步分析** - 按顺序分析PRD的各个部分
3. **必须识别不确定项** - 标记需要进一步确认的内容
4. **必须输出TRD** - 生成技术需求文档

## 任务目标

将PM产出的PRD文档转化为详细的功能需求文档(TRD)，深入分析业务流程和功能细节，标记不确定事项，为架构师提供清晰的功能需求指导。

## 输入要求

- 一个或多个PRD文档路径
- 项目基本信息（可选）

## 输出产物

- `docs/trd.md` - 技术需求文档
- `docs/trd_todo.md` - 待确认事项列表（如果有不确定项）

## 执行步骤

### 步骤1：PRD文档分析

1. **读取PRD文档**：加载用户提供的PRD文档
2. **文档结构分析**：分析PRD的章节结构和内容完整性
3. **需求提取**：从PRD中提取功能需求和非功能需求
4. **业务背景理解**：理解业务目标、成功指标和约束条件

### 步骤2：功能需求细化

1. **用户故事细化**：
   - 将PRD中的用户故事转化为详细的操作步骤
   - 明确用户角色、操作流程、期望结果
   - 识别用户操作的异常情况和处理逻辑
2. **业务流程分析**：
   - 详细分析核心业务流程的每个步骤
   - 识别业务决策点和分支逻辑
   - 确定业务规则和约束条件

3. **功能规格制定**：
   - 基于功能需求识别功能模块
   - 详细描述操作流程和数据流
   - 识别系统集成点和数据交换需求

### 步骤3：不确定项识别

1. **业务澄清识别**：
   - 标记需要业务方澄清的需求细节
   - 识别可能的业务逻辑冲突
   - 记录需要进一步确认的业务规则

2. **功能细节识别**：
   - 标记需要进一步明确的功能实现细节
   - 识别复杂的业务逻辑和异常处理
   - 记录需要详细说明的用户操作流程

### 步骤4：文档生成

1. **TRD文档生成**：
   - 使用trd-tmpl.yaml模板生成功能需求文档
   - 确保所有确定的功能需求都被记录
   - 保持文档结构清晰和逻辑完整

2. **待办事项生成**：
   - 如果有不确定项，生成trd_todo.md文档
   - 按优先级排序待确认事项
   - 为每个事项提供背景和影响分析

## 交互要求

当遇到以下情况时，需要与用户交互：

1. **PRD文档不完整**：询问缺失的部分或要求补充信息
2. **需求理解有歧义**：确认对需求的理解是否正确
3. **业务流程复杂**：当业务流程复杂时，询问具体的处理逻辑
4. **优先级确认**：确认功能需求的优先级排序

## 质量检查

完成TRD生成后，进行以下检查：

1. **完整性检查**：确保所有PRD需求都被转化为功能需求
2. **一致性检查**：确保功能需求与业务需求保持一致
3. **详细性检查**：确保功能需求描述详细，包含足够的实现细节
4. **清晰性检查**：确保功能需求描述清晰，架构师和开发团队能够理解

## 输出格式

### TRD文档结构

- 文档信息
- 业务背景
- 功能需求分析
- 非功能需求分析
- 功能规格
- 实现指导
- 待确认事项

### 待办事项文档结构

- 业务澄清列表
- 功能细节列表
- 业务规则列表
- 优先级排序
- 建议的解决路径

## 注意事项

1. **保持功能导向**：TRD应该专注于功能需求，为架构师提供清晰的功能指导
2. **确保详细性**：所有功能需求都应该详细描述，包含足够的实现细节
3. **标记不确定项**：不要猜测，不确定的内容要明确标记
4. **保持可追溯性**：功能需求要与PRD中的业务需求保持可追溯关系
5. **避免技术设计**：不要进行API设计、数据库设计等技术设计，这些交给架构师
